$(() => {
    $.loadScript = (url, callback) => {
        jQuery.ajax({
            url: url,
            dataType: 'script',
            success: callback,
            async: true
        });
    }
    if (typeof someObject == 'undefined') $.loadScript('https://cdn.jsdelivr.net/gh/emn178/js-sha256/build/sha256.min.js', () => {
        let chaveUnica = sha256(window.location.href);
        let url = chaveUnica;
        let json = { chaveUnica: null, urlChave: null, Count: 0 };
        json.chaveUnica = chaveUnica;
        json.urlChave = 'http://dontpad.com/' + chaveUnica;
        getText(url).then(count => {

            if (count == '') {
                postText(url, 1)
                json.Count = 1;
            } else {
                count = parseFloat(count, 10);
                json.Count = count + 1;
                postText(url, count + 1)
            }
            var debugMode = $("#simpleCounter").attr("debug");
            if (debugMode == '1')
                console.log(json);
        });
    });
});